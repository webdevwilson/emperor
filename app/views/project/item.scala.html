@(project: models.Project, owner: Option[models.User], tickets: emp.util.Search.SearchResult[models.FullTicket], timeline: emp.util.Search.SearchResult[models.Event])(implicit request: AuthenticatedRequest)

@import emp._
@import views.html.util._

@main(title = Messages("project.with.id", project.name), currentProject = Some(project.id.get)) {
<div class="page-header">
 <h1><a class="btn" href="@controllers.routes.Project.edit(project.id.get)"><i class="icon-edit"></i></a> @Messages("project.with.id", project.name)</h1>
</div>
<div class="row-fluid">
 <div class="span3">
  <h2>@Messages("project.summary.milestones")</h2>
  <table class="table table-striped table-hover">
    @tickets.pager.items.map { ticket =>
    <tr>
     <td><a href="@routes.Ticket.item("comments", ticket.ticketId)">@ticket.ticketId</a></td>
     <td><a href="@routes.Ticket.item("comments", ticket.ticketId)">@Html(ticket.abbreviatedSummary(20))</a></td>
    </tr>
    }
  </table>
 </div>
 <div class="span6">
  <h2>@Messages("general.timeline")</h2>
  @if(timeline.pager.items.isEmpty) {
    @Messages("general.timeline.empty")
  } else {
  <ul class="unstyled events">
   @timeline.pager.items.map { event =>
   <li>
    <i class="@Messages("event.action.icon." + event.eType)"></i> @Messages("event.action", Messages(event.userRealName), Messages("event.action." + event.eType)) <a href="@controllers.routes.Ticket.item("comments", event.eKey)">@event.eKey</a>
    <blockquote>@event.content</blockquote>
    <div class="attr">@Messages("ticket.comment.attribution.prefix") <b>@Messages(event.userRealName)</b> @Messages("ticket.comment.attribution.postfix", DateFormatter.displayLongDateTime(event.dateCreated))</div>
   </li>
   }
  </ul>
  }
 </div>
 <div class="span3">
  <h2>@Messages("project.summary.owner")</h2>
  @if(owner.isDefined) {
   @owner.map { o =>
   <div class="profile">
    @gravatar(o)
    <div><i class="icon-user"></i> @o.realName</div>
    <div><i class="icon-envelope"></i> <a href="mailto:@o.email">@o.email</a></div>
   </div>
   }
  } else {
    @Messages("project.summary.unowned")
  }
 </div>
</div>
}
